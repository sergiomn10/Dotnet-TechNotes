@page "/note-editor"

@inject ISender Sender

<PageTitle>Crear nota</PageTitle>

<h3>Crear nota</h3>

<EditForm Model="Note" OnSubmit="HandleSubmit" FormName="NoteEditorForm">
    <InputText @bind-Value="Note.Title" placeholder="Titulo" class="form-control mb-2" />
    <InputTextArea @bind-Value="Note.Content" placeholder="Contenido" class="form-control mb-2" rows="5" />
    <label>Fecha de publicacion:</label>
    <InputDate @bind-Value="Note.PublishedAt" class="form-control mb-2" />
    <label class="form-check-label mb-2">Publicacion:</label>
    <InputCheckbox @bind-Value="Note.IsPublished"  class="form-check-input mb-2"/>
    <button type="submit" class="btn btn-primary mt-3 w-100">Crear</button>
</EditForm>

@code {
    [SupplyParameterFromForm]
    private NoteModel Note { get; set; } = new NoteModel();
    private async Task HandleSubmit()
    {
        var command = Note.Adapt<CreateNoteCommand>();
        var result = await Sender.Send(command);
        Note = result.Adapt<NoteModel>();
        Console.WriteLine("Nota creada satisfactoriamente");
    }
}