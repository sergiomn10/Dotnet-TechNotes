NOTA: 	{
 		Los cambios se suben en cd Fullstack,
		La ejecucion de la app se hace en la capa de presentacion (cd TechNotes)
	}


// 1 Crear capas de Clean Architecture

	.Application
	.Domain
	.Infrastructure

// 2 Asignar dependencias entre proyectos

	Presentation(Principal) => Infrastructure
	Application		=> Domain
	Infrastructure 		=> Application

// 3 Instalar nuget package "Microsoft.Extensions.DependencyInjection.Abstractions" en la capa de Application
	
	Microsoft.Extensions.DependencyInjection.Abstractions

// 4 Agregar clase estatica DependencyInjection para configurar la inyeccion de las interfaces 

	public static IServiceCollection AddApplication(this IServiceCollection services)
    {
        services.AddScoped<INoteService, NoteService>();
        return services;
    }

// 5  Agregar la clase estatica de DependencyInjection en el program.cs para poder hacer las migraciones a la DB

	builder.Services.AddApplication(); // se coloca debajo de builder.Services.AddRazorComponents().AddInteractiveServerComponents();



// 6 Agregar clase ApplicationDbContext en capa Infrastruture

	ApplicationDbContext.cs



// 7 Instalar nuget package "EntityFrameworkCore" en Infrastructure

	Microsoft.EntityFrameworkCore

// 8 Agregar cadena de conexion en el appsettings.json

"ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Database=TechNotesDb;User ID=SA;Password=MyStrongPass123;TrustServerCertificate=true;MultipleActiveResultSets=true"
  },


// 9 Instalar nuget package "EntityFrameworkCore.SqlServer" en Infrastructure

	Microsoft.EntityFrameworkCore.SqlServer

// 10 Agregar clase estatica DependencyInjection para configurar las migraciones de la DB en Infrastructure


public static IServiceCollection AddInfrastructure(this IServiceCollection services, IConfiguration configuration)
    { ...

// 11 Agregar la clase estatica de DependencyInjection en el program.cs para poder hacer las migraciones a la DB

builder.Services.AddInfrastructure(builder.Configuration); // se coloca debajo de builder.Services.AddApplication();


// 12 Instalar nuget package "Microsoft.EntityFrameworkCore.Tools" en Infrastructure

	Microsoft.EntityFrameworkCore.Tools


// 13 Iniciar una migracion de DB moviendose a la carpeta Infrastructure

	cd ProjectName.Infrastructure

// 14 Ejecutar el comando para agregar una migracion 

	dotnet ef migrations add CreateTableNotes

// 15 Ejecutar el siguiente comando, Si sale este warning (The Entity Framework tools version '9.0.8' is older than that of the runtime '9.0.9'. Update the tools for the latest features and bug fixes. See https://aka.ms/AAc1fbw for more information.)

	dotnet tool update --global dotnet-ef

// 16 Actualizar la clase ApplicationDbContext.cs, Si sale este error (Unable to create a 'DbContext' of type 'RuntimeType'. The exception 'Unable to resolve service for type 'Microsoft.EntityFrameworkCore.DbContextOptions' while attempting to activate 'TechNotes.Infrastructure.ApplicationDbContext'.' was thrown while attempting to create an instance. For the different patterns supported at design time, see https://go.microsoft.com/fwlink/?linkid=851728)

	public ApplicationDbContext(DbContextOptions<ApplicationDbContext> options) : base(options)
    	{
    	}

// 17 Crear clase ApplicationDbContextFactory en infrastructure , Si sale este error (Unable to create a 'DbContext' of type 'RuntimeType'. The exception 'Unable to resolve service for type 'Microsoft.EntityFrameworkCore.DbContextOptions`1[TechNotes.Infrastructure.ApplicationDbContext]' while attempting to activate 'TechNotes.Infrastructure.ApplicationDbContext'.' was thrown while attempting to create an instance. For the different patterns supported at design time, see https://go.microsoft.com/fwlink/?linkid=851728)


public class ApplicationDbContextFactory : IDesignTimeDbContextFactory<ApplicationDbContext>
{
    public ApplicationDbContext CreateDbContext(string[] args)
    {
        var optionsBuilder = new DbContextOptionsBuilder<ApplicationDbContext>();
        optionsBuilder.UseSqlServer(
            "Server=localhost;Database=TechNotesDb;User ID=SA;Password=MyStrongPass123;TrustServerCertificate=true;MultipleActiveResultSets=true"
            , b => b.MigrationsAssembly("TechNotes.Infrastructure"));

        return new ApplicationDbContext(optionsBuilder.Options);
    }
}
	

// 18 Ya creada la migracion se necesita reflejar los datos en DB y antes de ejecutar el comando levantar el contenedor de docker

	dotnet ef database update

// 19 Actualizar las cadenas de conexion agregando el puerto en el sever local, Si sale este error (Login failed for user 'SA'.) o verificar bien la cadena de conexion

 "DefaultConnection": "Server=localhost,1433;Database=TechNotesDb; ....


// 20  Instalar nuget package "MediatR" para usar el patron Mediador con CQRS en Application 

	MediatR 

// 21 Agregar la inyeccion de mediator en la clase de DependencyInjection en Application
	
	public static IServiceCollection AddApplication(this IServiceCollection services)
    {
        services.AddMediatR(configuration =>
        {
            configuration.RegisterServicesFromAssembly(typeof(DependencyInjection).Assembly);
        });
        services.AddScoped<INo  ...


// 22 Instalar nuget package "Mapster" en Application

	Mapster

// 23 Restructurar carpetas de la capa principal (presentacion )

	-Crear carpeta Features y agregar dentro los componentes con responsabilidad unica por carpeta (Components,.Model)
	-Crear carpeta Page y agregar Home.Razor
	-Crear carpeta Shared y agregar Error, MainLayout, NavMenu .razor
	-Colocar en capa principal los archivos App.razor, Routes, _imports . razor

// 24 Agregar la clase generica Result.cs en Domain para el manejo de retorno de datos mas abstracto entre las clases y capas

	Abstractions/Result.cs

// 25 Agregar las interfaces para Implementar la clase generica Result con el patron MediatR, en query y Command

	Abstractions/RequestHandling/ICommand.cs
	Abstractions/RequestHandling/ICommandHandler.cs
	Abstractions/RequestHandling/IQuery.cs
	Abstractions/RequestHandling/IQueryHandler.cs

// 26 Implementar las interfases genericas, en las clases Command y Query en Application

	public class CreateNoteCommand : ICommand<NoteResponse> ...
	public class GetNoteByIdQuery : IQuery<NoteResponse?> ...

// 27 Instalar Tailwind CSS (en la carpeta del proyecto Blazor) donde se debe tener instalado Node.js y npm.
	Seguir esta guia de connfiguracion https://gist.github.com/pazteddy/d839253de6e930e9383822b13c16c430 o 
	https://tailwindcss.com/

	npm install tailwindcss @tailwindcss/cli

// 28  Tener en una termianl siempre ejecutando el siguiente comando mientras se ajustan los estilos con Tailwind 
       para que mantenga actualizado el css automatico con los ultimos cambios agregados
 
	
	npx tailwindcss -i ./Styles/input.css -o ./wwwroot/tailwind.css --watch

// 29 Se utilizo el siguiente prompt para pedir a la IA del chat de VScode ajuste los estilos del formulario editar

	"
		Por favor cambia los estilos para que el formulario visualmente sea lo mas profesional posible,
		pero siguiendo los lineamientos de estos componentes:
		https://www.hyperui.dev/
		Por favor no utilices estilos personalizados, solo los de Tailwind

"

// 30  Agregar el paquete de identity para hacer las autenticaciones en la capa de Infrastructure

	"Microsoft.AspNetCore.Identity.EntityFrameworkCore" Version="9.0.9"

// 31 Agregar el paquete de identity.UI para hacer las autenticaciones en la capa de Infrastructure

	"Microsoft.AspNetCore.Identity.UI" Version="9.0.9"


//  32  Despues de haber agregado el User en domain e infra, se debe cambiar el dbcontext por IdentityDbContext 
		en la clase de ApplicationDbContext en infra y posteriormente hacer una migracion de la DB

	namespace TechNotes.Infrastructure;

    public class ApplicationDbContext : IdentityDbContext<User>


//  33 Agragar la clase BlazorAuthorizationMiddlewareResultHandler y su inyeccion de dependencia para que redireccione 
		al contenido que agreguemos en el Routes.razor cuando entren a una pagina no autorizada y no muestra la pantalla fea de NotFound

		public class BlazorAuthorizationMiddlewareResultHandler : IAuthorizationMiddlewareResultHandler
		{
    		public Task HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
    		{
       			 return next(context);
    		}
		}

		...

		   services.AddSingleton<IAuthorizationMiddlewareResultHandler, BlazorAuthorizationMiddlewareResultHandler>();

// 34 Agregar el paquete de Authentication Google para hacer las autenticaciones con los cuentas de Google

		"Microsoft.AspNetCore.Authentication.Google"

// 35 Agregar el paquete de  Microsoft.AspNetCore.Components.QuickGrid en capa de presentacion
	Para proporcionar un componente de cuadrícula de datos conveniente, 
	simple y flexible para desarrolladores de Blazor con las necesidades más comunes

	"Microsoft.AspNetCore.Components.QuickGrid" Version="9.0.9"

// 36 Agregar el paquete de WebAssembly.Server para hacer la app que se ejecute de lado del cliente codigo c#

		"Microsoft.AspNetCore.Components.WebAssembly.Server" Version="9.0.9"

// 37 Agregar en el inicio del codigo de Program.cs .AddInteractiveWebAssemblyComponents() para que permita cargar componentes compilados con WebAssam...

	builder.Services.AddRazorComponents()
    .AddInteractiveServerComponents()
    .AddInteractiveWebAssemblyComponents();

// 38  Agregar en el fin del codigo de Program.cs .AddInteractiveWebAssemblyRenderMode()() para que permita cargar componentes compilados con WebAssam...

	app.MapRazorComponents<App>()
    .AddInteractiveServerRenderMode()
    .AddInteractiveWebAssemblyRenderMode();


////////////////////////////// Pasos para crear el proyecto Client de Web Assembly ///////////////////////////////////

//  39 Al crear proyecto 
	-Indicar nombre TechNotes.Client
	-Default directory
	-Antes del Clic en create project se debe editar opciones desmarcar indicando false en Include sample pages 

// 40 Eliminar paquete Microsoft.AspNetCore.Components.WebAssembly.DevServer del nuevo proyecto client 
		en clic derecho sobre el paquete y Remove NuGet package

	Microsoft.AspNetCore.Components.WebAssembly.DevServer

// 41 Eliminar todos los items del proyecto Client y solo quedarse con 

	Program.cs 
	_imports.razor

// 42 Dentro del Program.cs del proyecto client eliminar las siguientes dos lineas 

	builder.RootComponents.Add<App>("#app");
	builder.RootComponents.Add<HeadOutlet>("head::after");

// 43 En el archivo _imports.razor del proyecto client agregar y eliminar una linea 

	Agregar 
		@using static Microsoft.AspNetCore.Components.Web.RenderMode

	Eliminar 
		@using TechNotes.Client.Layout

// 44 En el proyecto de la capa de presentacion TechNotes agregar nueva dependencia de Client

	-Clic derecho en TechNotes y seleccionar Add Project Reference
	-Seleccionar el proyecto de TechNotes.Client

// 45 Agregar AddAdditionalAssemblies(typeof(TechNotes.Client._Imports).Assembly) 
	para que puedan funcionar los componentes WebAssembly , una vez que se tenga la estructura en el proyecto de Client

	app.MapRazorComponents<App>()
    .AddInteractiveServerRenderMode()
    .AddInteractiveWebAssemblyRenderMode()
    .AddAdditionalAssemblies(typeof(TechNotes.Client._Imports).Assembly);

// 46 En el proyecto de la capa de  TechNotes.Client agregar nueva dependencia de Application

	-Clic derecho en TechNotes.Client y seleccionar Add Project Reference
	-Seleccionar el proyecto de TechNotes.Application

// 47 Agregar el paquete de  Microsoft.AspNetCore.Components.QuickGrid en capa de TechNotes.Client
	Para proporcionar un componente de cuadrícula de datos conveniente, 
	simple y flexible para desarrolladores de Blazor con las necesidades más comunes

	"Microsoft.AspNetCore.Components.QuickGrid" Version="9.0.9"

